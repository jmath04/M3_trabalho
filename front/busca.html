<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Buscar Moradores</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* CSS Básico para organizar os 5 campos */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2 colunas */
            gap: 10px;
            margin-bottom: 15px;
        }
        .form-grid input {
            padding: 8px;
            width: 100%;
            box-sizing: border-box; /* Garante que o padding não quebre o layout */
        }
        /* O botão ocupa a largura total abaixo dos inputs */
        .full-width {
            grid-column: span 2; 
        }
    </style>
</head>

<body>

<header>Buscar Moradores</header>

<div class="container">

    <h2>Buscar Moradores</h2>

    <div class="form-section">
        <div class="form-grid">
            <input type="text" id="inpNome" placeholder="Nome">
            <input type="text" id="inpSobrenome" placeholder="Sobrenome">
            <input type="email" id="inpEmail" placeholder="Email">
            <input type="text" id="inpRg" placeholder="RG">
            <input type="text" id="inpTelefone" placeholder="Telefone" class="full-width">
        </div>
        <button id="btnBuscar" style="width: 100%;">Buscar</button>
    </div>

    <table id="tabela" style="display:none;">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Sobrenome</th>
                <th>Email</th>
                <th>RG</th>
                <th>Telefone</th>
            </tr>
        </thead>
        <tbody id="resultado"></tbody>
    </table>

</div>

<script>
function buscar() {
    // 1. Capturar os valores individuais
    const nome = document.getElementById("inpNome").value.trim();
    const sobrenome = document.getElementById("inpSobrenome").value.trim();
    const email = document.getElementById("inpEmail").value.trim();
    const rg = document.getElementById("inpRg").value.trim();
    const telefone = document.getElementById("inpTelefone").value.trim();
    
    const tabela = document.getElementById("tabela");
    const corpo = document.getElementById("resultado");

    corpo.innerHTML = "";
    tabela.style.display = "none";

    // 2. Montar a Query String (ex: ?nome=joao&rg=123)
    // O URLSearchParams facilita muito isso, ele ignora o que for undefined se configurado, 
    // mas aqui vamos passar tudo e o backend trata os vazios.
    const params = new URLSearchParams({
        nome: nome,
        sobrenome: sobrenome,
        email: email,
        rg: rg,
        telefone: telefone
    });

    // A URL final ficará algo como: /api/busca?nome=Valor&sobrenome=&email=...
    fetch(`/api/busca?${params.toString()}`)
        .then(res => res.json())
        .then(lista => {

            if (!Array.isArray(lista) || lista.length === 0) {
                // Opcional: Mostrar aviso de "Nenhum resultado"
                return;
            }

            lista.forEach(m => {
                corpo.innerHTML += `
                    <tr>
                        <td>${m.nome}</td>
                        <td>${m.sobrenome}</td>
                        <td>${m.email}</td>
                        <td>${m.rg}</td>
                        <td>${m.telefone}</td>
                    </tr>
                `;
            });

            tabela.style.display = "table";
        })
        .catch(err => console.error("Erro na busca:", err));
}

document.getElementById("btnBuscar").addEventListener("click", buscar);

// Adiciona o evento de Enter para TODOS os inputs
const inputs = document.querySelectorAll("input");
inputs.forEach(input => {
    input.addEventListener("keypress", (e) => {
        if (e.key === "Enter") buscar();
    });
});
</script>

</body>
</html>